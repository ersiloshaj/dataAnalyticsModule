<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Roadmap</title>

  <style>
    :root{
      --bg:#0b1020;
      --panel:#121a33;
      --panel2:#0f1630;
      --text:#e8ecff;
      --muted:#b9c2ff;
      --border:rgba(255,255,255,0.12);
      --shadow: 0 18px 45px rgba(0,0,0,0.35);
      --ring: 0 0 0 3px rgba(122,162,255,0.35);

      --done1:#ffe07a;
      --done2:#ffb800;

      --next1:#a9b9ff;
      --next2:#6f8dff;

      --locked1:#cfd3df;
      --locked2:#9aa3b8;

      --accent:#7aa2ff;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: var(--sans);
      color: var(--text);
      background:
        radial-gradient(1100px 720px at 20% 0%, rgba(122,162,255,0.18), transparent 60%),
        radial-gradient(900px 700px at 85% 10%, rgba(255,184,0,0.10), transparent 55%),
        radial-gradient(900px 700px at 40% 95%, rgba(185,194,255,0.10), transparent 55%),
        var(--bg);
      overflow-x:hidden;
    }

    .wrap{ max-width: 980px; margin: 0 auto; padding: 26px 16px 60px; }

    header{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:14px;
      flex-wrap:wrap;
      margin-bottom: 16px;
    }
    h1{ margin:0; font-size: clamp(22px, 2.6vw, 34px); line-height:1.15; }
    .subtitle{ margin-top:6px; color: var(--muted); font-size: 14px; max-width: 75ch; }

    .topbar{
      display:flex; gap:10px; align-items:center; flex-wrap:wrap; justify-content:flex-end;
    }
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px; border-radius:999px;
      border:1px solid var(--border);
      background: rgba(255,255,255,0.04);
      color: var(--muted);
      box-shadow: 0 10px 30px rgba(0,0,0,0.22);
      user-select:none; font-size: 13px; white-space:nowrap;
    }
    .pill strong{ color: var(--text); font-weight: 820; }

    .btn{
      cursor:pointer;
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(255,255,255,0.05);
      color: var(--muted);
      padding: 9px 12px;
      border-radius: 12px;
      font-weight: 720;
      transition: transform .12s ease, background .12s ease, border-color .12s ease, color .12s ease;
      box-shadow: 0 12px 35px rgba(0,0,0,0.25);
      display:inline-flex;
      align-items:center;
      gap:10px;
    }
    .btn:hover{
      transform: translateY(-1px);
      background: rgba(255,255,255,0.07);
      border-color: rgba(255,255,255,0.22);
      color: var(--text);
    }
    .btn:active{ transform: translateY(0px) scale(0.99); }
    .btn:focus{ outline:none; box-shadow: var(--shadow), var(--ring); }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02));
      border: 1px solid var(--border);
      border-radius: 18px;
      padding: 14px;
      box-shadow: var(--shadow);
    }

    .controls{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      margin: 14px 0 16px;
    }

    .input{
      flex: 1 1 320px;
      min-width: 240px;
      display:flex;
      gap:10px;
      align-items:center;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(10,15,31,0.55);
    }
    .input input{
      width:100%;
      border:0;
      outline:none;
      background: transparent;
      color: var(--text);
      font-size: 14px;
    }
    .input input::placeholder{ color: rgba(185,194,255,0.55); }

    .chips{ display:flex; gap:8px; flex-wrap:wrap; }
    .chip{
      cursor:pointer; user-select:none;
      font-size: 12.5px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(255,255,255,0.03);
      color: var(--muted);
      transition: background .12s ease, border-color .12s ease, transform .12s ease, color .12s ease;
      white-space:nowrap;
    }
    .chip:hover{
      background: rgba(122,162,255,0.10);
      border-color: rgba(122,162,255,0.28);
      transform: translateY(-1px);
      color: var(--text);
    }
    .chip.active{
      background: rgba(255,184,0,0.12);
      border-color: rgba(255,184,0,0.38);
      color: var(--text);
      font-weight: 760;
    }

    /* Sections */
    .section{
      margin-top: 14px;
      border: 1px solid rgba(255,255,255,0.10);
      border-radius: 18px;
      overflow:hidden;
      background: rgba(255,255,255,0.02);
    }
    .sectionHead{
      padding: 12px 14px;
      border-bottom: 1px solid rgba(255,255,255,0.10);
      background: rgba(255,255,255,0.02);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
    }
    .sectionHead h2{ margin:0; font-size: 14.5px; letter-spacing:.2px; }
    .sectionHead .meta{ color: var(--muted); font-size: 12.5px; }

    /* Roadmap list */
    .road{
      position: relative;
      padding: 14px;
    }

    /* Vertical path line behind icons */
    .road::before{
      content:"";
      position:absolute;
      left: 34px;
      top: 18px;
      bottom: 18px;
      width: 2px;
      background:
        repeating-linear-gradient(
          to bottom,
          rgba(255,255,255,0.22),
          rgba(255,255,255,0.22) 5px,
          transparent 5px,
          transparent 12px
        );
      opacity: 0.55;
      pointer-events:none;
    }

    .row{
      display:flex;
      gap: 14px;
      align-items:center;
      padding: 10px 4px;
      position: relative;
    }

    .node{
      flex: 0 0 auto;
      width: 60px;
      height: 60px;
      border-radius: 999px;
      display:grid;
      place-items:center;
      border: 1px solid rgba(255,255,255,0.16);
      box-shadow: 0 16px 40px rgba(0,0,0,0.30);
      position: relative;
      z-index: 1;
      transition: transform .12s ease;
    }
    .row:hover .node{ transform: translateY(-1px); }

    .node svg{ width: 26px; height: 26px; }

    .node[data-status="done"]{
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.25), transparent 55%),
                  linear-gradient(180deg, var(--done1), var(--done2));
      color: rgba(70,40,0,0.95);
    }
    .node[data-status="next"]{
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.22), transparent 55%),
                  linear-gradient(180deg, var(--next1), var(--next2));
      color: rgba(0,10,40,0.95);
    }
    .node[data-status="locked"]{
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.18), transparent 55%),
                  linear-gradient(180deg, var(--locked1), var(--locked2));
      color: rgba(20,24,38,0.95);
      opacity: 0.9;
    }

    .content{
      flex: 1 1 auto;
      min-width: 0;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      padding: 12px 12px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(15,22,48,0.55);
      box-shadow: 0 14px 40px rgba(0,0,0,0.22);
      text-decoration:none;
      color: inherit;
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
    }
    .content:hover{
      transform: translateY(-1px);
      border-color: rgba(122,162,255,0.35);
      background: rgba(18,26,51,0.68);
    }
    .content:focus{ outline:none; box-shadow: 0 14px 40px rgba(0,0,0,0.22), var(--ring); }

    .left{
      min-width:0;
    }
    .title{
      margin:0;
      font-weight: 860;
      font-size: 14.5px;
      line-height:1.2;
    }
    .desc{
      margin-top: 5px;
      color: var(--muted);
      font-size: 12.8px;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
      max-width: 75ch;
    }

    .badges{
      margin-top: 8px;
      display:flex;
      gap: 8px;
      flex-wrap:wrap;
    }
    .badge{
      font-size: 11.5px;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(255,255,255,0.03);
      color: var(--muted);
    }

    .right{
      flex: 0 0 auto;
      display:flex;
      gap: 10px;
      align-items:center;
      color: var(--muted);
      font-size: 12.5px;
      white-space:nowrap;
    }
    .right .miniDot{
      width: 9px; height: 9px; border-radius: 999px;
      background: rgba(255,255,255,0.22);
      border: 1px solid rgba(255,255,255,0.14);
    }
    .content[data-status="done"] .miniDot{ background: rgba(255,184,0,0.95); border-color: rgba(255,184,0,0.35); }
    .content[data-status="next"] .miniDot{ background: rgba(122,162,255,0.95); border-color: rgba(122,162,255,0.35); }
    .content[data-status="locked"] .miniDot{ background: rgba(154,163,184,0.85); border-color: rgba(154,163,184,0.35); }

    .content[data-status="locked"]{
      cursor:not-allowed;
      opacity: 0.72;
    }
    .content[data-status="locked"]:hover{
      transform:none;
      border-color: rgba(255,255,255,0.12);
      background: rgba(15,22,48,0.55);
    }

    footer{
      margin-top: 18px;
      color: var(--muted);
      font-size: 13px;
      display:flex;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
    }
    .mono{ font-family: var(--mono); }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Roadmap</h1>
        <div class="subtitle">
          Icons on the left, titles on the right. Edit the <span class="mono">ROADMAP</span> array to fill in lessons.
        </div>
      </div>

      <div class="topbar">
        <div class="pill"><strong id="kpiDone">0</strong> done</div>
        <div class="pill"><strong id="kpiNext">0</strong> next</div>
        <div class="pill"><strong id="kpiLocked">0</strong> locked</div>
        <button class="btn" id="btnReset" type="button">Reset progress</button>
      </div>
    </header>

    <div class="card controls">
      <div class="input" role="search">
        <svg viewBox="0 0 24 24" fill="none" aria-hidden="true" style="width:18px;height:18px;">
          <path d="M10 18a8 8 0 1 1 0-16 8 8 0 0 1 0 16Z" stroke="currentColor" stroke-width="2"/>
          <path d="M21 21l-4.3-4.3" stroke="currentColor" stroke-width="2"/>
        </svg>
        <input id="q" type="search" placeholder="Search lessons, projects, keywordsâ€¦" autocomplete="off" />
      </div>

      <div class="chips" aria-label="Filters">
        <div class="chip active" data-filter="all">All</div>
        <div class="chip" data-filter="next">Next</div>
        <div class="chip" data-filter="done">Done</div>
        <div class="chip" data-filter="locked">Locked</div>
      </div>
    </div>

    <div id="mount"></div>

    <footer>
      <div>Progress saved in <span class="mono">localStorage</span>.</div>
      <div>Tip: duplicate items in <span class="mono">ROADMAP</span> to fill quickly.</div>
    </footer>
  </div>

  <script>
    /*****************************************************************
     * EDIT ME: Course structure
     *****************************************************************/
    const ROADMAP = [
      {
        section: "Week 1: Foundations",
        items: [
          { id:"w1-setup", title:"Orientation + project setup", desc:"Folder structure, scripts, reading CSVs", href:"monday.html", status:"done", tags:["setup","csv"] },
          { id:"w1-clean", title:"Data wrangling & cleaning", desc:"Missing data, types, joins", href:"tuesday.html", status:"next", tags:["dplyr","cleaning"] },
          { id:"w1-line",  title:"Line graphs", desc:"Ridership over time", href:"linegraphs.html", status:"locked", lockReason:"Finish Data wrangling & cleaning first.", tags:["ggplot","time"] },
          { id:"w1-box",   title:"Box plots", desc:"Compare delays by mode", href:"boxplots.html", status:"locked", lockReason:"Finish Data wrangling & cleaning first.", tags:["ggplot","distribution"] },
        ]
      },
      {
        section: "Week 2: Dashboard Build",
        items: [
          { id:"w2-shiny", title:"Intro to Shiny", desc:"UI vs server, reactivity", href:"notes.html", status:"locked", lockReason:"Finish Week 1 plots first.", tags:["shiny"] },
          { id:"w2-tasks", title:"Shiny build tasks", desc:"Inputs, filtered data, downloads", href:"tasks.html", status:"locked", lockReason:"Finish Intro to Shiny first.", tags:["shiny","tasks"] }
        ]
      }
    ];

    const LS_KEY = "roadmapProgress.v2";

    function esc(s){
      return String(s ?? "").replace(/[&<>"']/g, m => ({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
      })[m]);
    }

    function loadProgress(){
      try{
        const raw = localStorage.getItem(LS_KEY);
        return raw ? JSON.parse(raw) : {};
      }catch{ return {}; }
    }
    function saveProgress(p){ localStorage.setItem(LS_KEY, JSON.stringify(p)); }

    function flatten(sections){
      const out = [];
      for(const sec of sections){
        for(const it of sec.items) out.push({ ...it, section: sec.section });
      }
      return out;
    }

    function iconSVG(status){
      if(status === "done"){
        return `<svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M6 12.5l4 4L18.5 8" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>`;
      }
      if(status === "next"){
        return `<svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M12 2l1.6 6.2L20 10l-6.4 1.8L12 18l-1.6-6.2L4 10l6.4-1.8L12 2Z" stroke="currentColor" stroke-width="2"/>
        </svg>`;
      }
      return `<svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M7 11V8a5 5 0 0 1 10 0v3" stroke="currentColor" stroke-width="2"/>
        <path d="M6 11h12v10H6V11Z" stroke="currentColor" stroke-width="2"/>
      </svg>`;
    }

    function matchesQuery(item, q){
      if(!q) return true;
      const hay = [item.title, item.desc, item.section, ...(item.tags||[])].join(" ").toLowerCase();
      return hay.includes(q.toLowerCase());
    }
    function matchesFilter(item, f){
      if(f === "all") return true;
      return item.status === f;
    }

    function kpis(items){
      const done = items.filter(x => x.status === "done").length;
      const next = items.filter(x => x.status === "next").length;
      const locked = items.filter(x => x.status === "locked").length;
      return { done, next, locked };
    }

    function mount(){
      const progress = loadProgress();

      // Apply saved overrides
      const sections = ROADMAP.map(sec => ({
        section: sec.section,
        items: sec.items.map(it => ({
          ...it,
          status: progress[it.id]?.status || it.status
        }))
      }));

      const all = flatten(sections);
      const k = kpis(all);
      document.getElementById("kpiDone").textContent = k.done;
      document.getElementById("kpiNext").textContent = k.next;
      document.getElementById("kpiLocked").textContent = k.locked;

      const q = document.getElementById("q").value.trim();
      const filter = document.querySelector(".chip.active")?.dataset.filter || "all";

      const html = sections.map(sec => {
        const items = sec.items.filter(it => matchesQuery(it, q)).filter(it => matchesFilter(it, filter));
        return `
          <div class="section">
            <div class="sectionHead">
              <h2>${esc(sec.section)}</h2>
              <div class="meta">${items.length} shown</div>
            </div>
            <div class="road">
              ${items.length ? items.map(it => {
                const locked = it.status === "locked";
                const hint = locked ? (it.lockReason || "Locked.") : (it.desc || "");
                const tags = (it.tags||[]).slice(0,3).map(t => `<span class="badge">${esc(t)}</span>`).join("");

                return `
                  <div class="row">
                    <div class="node" data-status="${esc(it.status)}" title="${esc(it.status)}">
                      ${iconSVG(it.status)}
                    </div>

                    <a class="content"
                       href="${locked ? "#" : esc(it.href || "#")}"
                       data-status="${esc(it.status)}"
                       data-id="${esc(it.id)}"
                       ${locked ? 'aria-disabled="true"' : ''}>
                      <div class="left">
                        <div class="title">${esc(it.title)}</div>
                        <div class="desc" title="${esc(hint)}">${esc(hint)}</div>
                        <div class="badges">${tags}</div>
                      </div>
                      <div class="right">
                        <span class="miniDot" aria-hidden="true"></span>
                        <span>${esc(it.status)}</span>
                      </div>
                    </a>
                  </div>
                `;
              }).join("") : `<div style="color:var(--muted); padding: 8px 4px;">No matching items.</div>`}
            </div>
          </div>
        `;
      }).join("");

      document.getElementById("mount").innerHTML = html;

      // Intercept locked clicks
      document.querySelectorAll('.content[data-status="locked"]').forEach(a => {
        a.addEventListener("click", (e) => {
          e.preventDefault();
          const id = a.dataset.id;
          const item = flatten(sections).find(x => x.id === id);
          alert(item?.lockReason || "This item is locked.");
        });
      });

      // Optional: mark as done with Alt+Click
      document.querySelectorAll('.content:not([data-status="locked"])').forEach(a => {
        a.addEventListener("click", (e) => {
          if(!e.altKey) return; // normal click opens link
          e.preventDefault();
          const id = a.dataset.id;
          progress[id] = { status: "done" };
          saveProgress(progress);
          mount();
        });
      });
    }

    // Filters
    document.querySelectorAll(".chip").forEach(chip => {
      chip.addEventListener("click", () => {
        document.querySelectorAll(".chip").forEach(c => c.classList.remove("active"));
        chip.classList.add("active");
        mount();
      });
    });

    document.getElementById("q").addEventListener("input", mount);

    document.getElementById("btnReset").addEventListener("click", () => {
      localStorage.removeItem(LS_KEY);
      mount();
    });

    mount();
  </script>
</body>
</html>
